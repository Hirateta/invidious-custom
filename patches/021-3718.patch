From e0600f455393ffcf0edd2f0c4b644fac7dba209f Mon Sep 17 00:00:00 2001
From: Emilien Devos <contact@emiliendevos.be>
Date: Fri, 31 Mar 2023 22:08:09 +0200
Subject: [PATCH] quick fix for channel videos page

---
 src/invidious/channels/videos.cr       | 4 +++-
 src/invidious/yt_backend/extractors.cr | 1 +
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/invidious/channels/videos.cr b/src/invidious/channels/videos.cr
index befec03d5c..3d53f2ab69 100644
--- a/src/invidious/channels/videos.cr
+++ b/src/invidious/channels/videos.cr
@@ -30,7 +30,9 @@ def produce_channel_videos_continuation(ucid, page = 1, auto_generated = nil, so
         "15:embedded" => {
           "1:embedded" => {
             "1:string" => object_inner_2_encoded,
-            "2:string" => "00000000-0000-0000-0000-000000000000",
+          },
+          "2:embedded" => {
+            "1:string" => "00000000-0000-0000-0000-000000000000",
           },
           "3:varint" => sort_by_numerical,
         },
diff --git a/src/invidious/yt_backend/extractors.cr b/src/invidious/yt_backend/extractors.cr
index b14ad7b952..978e380d05 100644
--- a/src/invidious/yt_backend/extractors.cr
+++ b/src/invidious/yt_backend/extractors.cr
@@ -773,6 +773,7 @@ end
 def extract_items(initial_data : InitialData, &block)
   if unpackaged_data = initial_data["contents"]?.try &.as_h
   elsif unpackaged_data = initial_data["response"]?.try &.as_h
+  elsif unpackaged_data = initial_data.dig?("onResponseReceivedActions", 1).try &.as_h
   elsif unpackaged_data = initial_data.dig?("onResponseReceivedActions", 0).try &.as_h
   else
     unpackaged_data = initial_data
